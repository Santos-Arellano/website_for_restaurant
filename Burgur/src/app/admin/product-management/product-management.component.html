<div class="product-management-container">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">Gestión de Productos</h1>
      <p class="page-subtitle">Administra el menú de tu restaurante</p>
    </div>
    <div class="header-actions">
      <button class="btn-primary" (click)="openAddModal()">
        <i class="fas fa-plus"></i>
        Agregar Producto
      </button>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters-section">
    <div class="search-box">
      <i class="fas fa-search"></i>
      <input 
          type="text" 
          placeholder="Buscar productos..." 
          [(ngModel)]="searchTerm"
          (input)="onSearchChange($any($event.target).value)"
        >
    </div>
    
    <div class="category-filters">
      <button 
        *ngFor="let category of categories" 
        class="filter-btn"
        [class.active]="selectedCategory === category.id"
        (click)="onCategoryChange(category.id)"
      >
        {{ category.name }} ({{ category.count }})
      </button>
    </div>
  </div>

  <!-- Products Grid -->
  <div class="products-grid">
    <div 
      class="product-card" 
      *ngFor="let product of filteredProducts; trackBy: trackByProductId"
      [class.inactive]="!product.active"
    >
      <div class="product-image">
        <img [src]="product.image" [alt]="product.name" onerror="this.src='/assets/images/default-product.jpg'">
        <div class="product-status" [ngClass]="getStockStatus(product.stock)">
          {{ getStockText(product.stock) }}
        </div>
      </div>
      
      <div class="product-info">
        <h3 class="product-name">{{ product.name }}</h3>
        <p class="product-description">{{ product.description }}</p>
        <div class="product-details">
          <span class="product-price">{{ formatCurrency(product.price) }}</span>
          <span class="product-category">{{ product.category }}</span>
        </div>
        <div class="product-stock">
          <i class="fas fa-box"></i>
          Stock: {{ product.stock }}
        </div>
      </div>
      
      <div class="product-actions">
        <button class="btn-edit" (click)="openEditModal(product)" title="Editar">
          <i class="fas fa-edit"></i>
        </button>
        <button 
          class="btn-toggle" 
          (click)="toggleProductStatus(product.id)"
          [title]="product.active ? 'Desactivar' : 'Activar'"
        >
          <i class="fas" [ngClass]="product.active ? 'fa-eye' : 'fa-eye-slash'"></i>
        </button>
        <button class="btn-delete" (click)="deleteProduct(product.id)" title="Eliminar">
          <i class="fas fa-trash"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="filteredProducts.length === 0">
    <i class="fas fa-search"></i>
    <h3>No se encontraron productos</h3>
    <p>Intenta cambiar los filtros o agregar nuevos productos</p>
  </div>
</div>

<!-- Add Product Modal -->
<div class="modal-overlay" *ngIf="showAddModal" (click)="closeAddModal()">
  <div class="modal-content modal-form" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Agregar Nuevo Producto</h2>
      <button class="btn-close" (click)="closeAddModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <form class="modal-form" (ngSubmit)="addProduct()">
      <div class="form-group">
        <label for="productName">Nombre del Producto</label>
        <input 
          type="text" 
          id="productName"
          [(ngModel)]="newProduct.name"
          name="productName"
          required
          placeholder="Ej: Hamburguesa Especial"
        >
      </div>
      
      <div class="form-group">
        <label for="productDescription">Descripción</label>
        <textarea 
          id="productDescription"
          [(ngModel)]="newProduct.description"
          name="productDescription"
          rows="3"
          placeholder="Describe el producto..."
        ></textarea>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="productPrice">Precio</label>
          <input 
            type="number" 
            id="productPrice"
            [(ngModel)]="newProduct.price"
            name="productPrice"
            required
            min="0"
            placeholder="0"
          >
        </div>
        
        <div class="form-group">
          <label for="productStock">Stock</label>
          <input 
            type="number" 
            id="productStock"
            [(ngModel)]="newProduct.stock"
            name="productStock"
            required
            min="0"
            placeholder="0"
          >
        </div>
      </div>
      
      <div class="form-group">
        <label for="productCategory">Categoría</label>
        <select 
          id="productCategory"
          [(ngModel)]="newProduct.category"
          name="productCategory"
          required
        >
          <option value="Hamburguesas">Hamburguesas</option>
          <option value="Acompañamientos">Acompañamientos</option>
          <option value="Bebidas">Bebidas</option>
        </select>
      </div>
      
      <div class="form-group checkbox-group">
        <label class="checkbox-label">
          <input 
            type="checkbox" 
            [(ngModel)]="newProduct.active"
            name="productActive"
          >
          <span class="checkmark"></span>
          Producto activo
        </label>
      </div>
      
      <div class="modal-actions">
        <button type="button" class="btn-secondary" (click)="closeAddModal()">
          Cancelar
        </button>
        <button type="submit" class="btn-primary">
          Agregar Producto
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Edit Product Modal -->
<div class="modal-overlay" *ngIf="showEditModal" (click)="closeEditModal()">
  <div class="modal-content modal-form" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Editar Producto</h2>
      <button class="btn-close" (click)="closeEditModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <form class="modal-form" (ngSubmit)="updateProduct()" *ngIf="selectedProduct">
      <div class="form-group">
        <label for="editProductName">Nombre del Producto</label>
        <input 
          type="text" 
          id="editProductName"
          [(ngModel)]="selectedProduct.name"
          name="editProductName"
          required
        >
      </div>
      
      <div class="form-group">
        <label for="editProductDescription">Descripción</label>
        <textarea 
          id="editProductDescription"
          [(ngModel)]="selectedProduct.description"
          name="editProductDescription"
          rows="3"
        ></textarea>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="editProductPrice">Precio</label>
          <input 
            type="number" 
            id="editProductPrice"
            [(ngModel)]="selectedProduct.price"
            name="editProductPrice"
            required
            min="0"
          >
        </div>
        
        <div class="form-group">
          <label for="editProductStock">Stock</label>
          <input 
            type="number" 
            id="editProductStock"
            [(ngModel)]="selectedProduct.stock"
            name="editProductStock"
            required
            min="0"
          >
        </div>
      </div>
      
      <div class="form-group">
        <label for="editProductCategory">Categoría</label>
        <select 
          id="editProductCategory"
          [(ngModel)]="selectedProduct.category"
          name="editProductCategory"
          required
        >
          <option value="Hamburguesas">Hamburguesas</option>
          <option value="Acompañamientos">Acompañamientos</option>
          <option value="Bebidas">Bebidas</option>
        </select>
      </div>
      
      <div class="form-group checkbox-group">
        <label class="checkbox-label">
          <input 
            type="checkbox" 
            [(ngModel)]="selectedProduct.active"
            name="editProductActive"
          >
          <span class="checkmark"></span>
          Producto activo
        </label>
      </div>
      
      <div class="modal-actions">
        <button type="button" class="btn-secondary" (click)="closeEditModal()">
          Cancelar
        </button>
        <button type="submit" class="btn-primary">
          Actualizar Producto
        </button>
      </div>
    </form>
  </div>
</div>