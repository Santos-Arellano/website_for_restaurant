<!-- Header -->
<header class="site-header" id="header">
  <div class="container header-container">
    <a routerLink="/" class="logo">
      <div class="logo-icon-wrapper">
        <img src="assets/images/Logo.png" alt="Burger Club Logo" class="logo-icon">
      </div>
      <span class="logo-text">BURGER CLUB</span>
    </a>

    <nav class="main-nav" id="mainNav">
      <ul>
        <li><a routerLink="/" class="nav-link">Inicio</a></li>
        <li><a routerLink="/menu" class="nav-link active">Men√∫</a></li>
        <li><a href="#about" class="nav-link">Sobre Nosotros</a></li>
        <li *ngIf="!isAuthenticated"><a routerLink="/auth/login" class="nav-link auth-link">Iniciar Sesi√≥n</a></li>
        <li *ngIf="!isAuthenticated"><a routerLink="/auth/register" class="nav-link auth-link">Registrarse</a></li>
        <li *ngIf="isAuthenticated"><a routerLink="/profile" class="nav-link">Perfil</a></li>
        <li>
          <a href="#" class="cart-link" (click)="openCart()">
            <i class="fas fa-shopping-cart"></i>
            <span>Carrito</span>
            <span class="cart-count">{{ cartItemCount }}</span>
          </a>
        </li>
      </ul>
    </nav>

    <div class="location-info" (click)="openLocationModal()">
      <i class="fas fa-map-marker-alt"></i>
      <span>Encu√©ntranos ac√°</span>
    </div>

    <button class="mobile-nav-toggle" (click)="toggleMobileMenu()" aria-label="Toggle navigation">
      <span class="hamburger-icon"></span>
    </button>
  </div>
</header>

<!-- Mobile Menu -->
<nav class="mobile-menu" [class.active]="isMobileMenuOpen">
  <ul>
    <li><a routerLink="/" class="mobile-nav-link" (click)="closeMobileMenu()">Inicio</a></li>
    <li><a routerLink="/menu" class="mobile-nav-link" (click)="closeMobileMenu()">Men√∫</a></li>
    <li><a href="#about" class="mobile-nav-link" (click)="closeMobileMenu()">Sobre Nosotros</a></li>
    <li *ngIf="!isAuthenticated"><a routerLink="/auth/login" class="mobile-nav-link mobile-auth-link" (click)="closeMobileMenu()">Iniciar Sesi√≥n</a></li>
    <li *ngIf="!isAuthenticated"><a routerLink="/auth/register" class="mobile-nav-link mobile-auth-link" (click)="closeMobileMenu()">Registrarse</a></li>
    <li *ngIf="isAuthenticated"><a routerLink="/profile" class="mobile-nav-link" (click)="closeMobileMenu()">Perfil</a></li>
    <li><a href="#" class="mobile-nav-link" (click)="openCart(); closeMobileMenu()">Carrito</a></li>
    <li><a href="#" class="mobile-nav-link" (click)="openLocationModal(); closeMobileMenu()">Ubicaci√≥n</a></li>
  </ul>
</nav>
<div class="mobile-menu-overlay" [class.active]="isMobileMenuOpen" (click)="closeMobileMenu()"></div>

<!-- Menu Section -->
<main id="menu" class="menu-section">
  <div class="page-wrapper">
    <!-- Background Decorations -->
    <div class="background-decorations">
      <div class="deco-item deco-1">üçî</div>
      <div class="deco-item deco-2">üçü</div>
      <div class="deco-item deco-3">ü•§</div>
      <div class="deco-item deco-4">üç∞</div>
      <div class="deco-item deco-5">‚ú®</div>
      <div class="deco-item deco-6">üí´</div>
    </div>

    <div class="container">
      <div class="menu-header">
        <h1 class="menu-title">NUESTRO MEN√ö</h1>
        <p class="menu-subtitle">Descubre nuestros sabores √∫nicos</p>
      </div>

      <!-- Barra de b√∫squeda -->
      <div class="menu-search-container">
        <form class="menu-search-form" (ngSubmit)="searchProducts()" role="search" aria-label="Buscar productos">
          <div class="search-input-wrapper">
            <i class="fas fa-search search-icon" aria-hidden="true"></i>
            <input
              type="text"
              [(ngModel)]="searchTerm"
              name="searchTerm"
              class="menu-search-input"
              placeholder="Buscar productos..."
              autocomplete="off"
              (input)="onSearchInput()" />
            <button class="search-submit" type="submit" aria-label="Buscar" style="display: none;">Buscar</button>
            <!-- Bot√≥n limpiar b√∫squeda -->
            <a *ngIf="searchTerm" class="search-clear" (click)="clearSearch()" aria-label="Limpiar b√∫squeda">
              <i class="fas fa-times" aria-hidden="true"></i>
            </a>
          </div>
        </form>
      </div>

      <!-- Filtros de categor√≠a -->
      <div class="menu-filters">
        <!-- Todos -->
        <a class="filter-btn" 
           [class.active]="selectedCategory === null"
           (click)="filterByCategory(null)">
          <i class="fas fa-th"></i><span>Todos</span>
        </a>

        <!-- Hamburguesas -->
        <a class="filter-btn" 
           [class.active]="selectedCategory === 'hamburguesa'"
           (click)="filterByCategory('hamburguesa')">
          <i class="fas fa-hamburger"></i><span>Hamburguesas</span>
        </a>

        <!-- Acompa√±amientos -->
        <a class="filter-btn" 
           [class.active]="selectedCategory === 'acompa√±amiento'"
           (click)="filterByCategory('acompa√±amiento')">
          <i class="fas fa-utensils"></i><span>Acompa√±amientos</span>
        </a>

        <!-- Perros Calientes -->
        <a class="filter-btn" 
           [class.active]="selectedCategory === 'perro caliente'"
           (click)="filterByCategory('perro caliente')">
          <i class="fas fa-hotdog"></i><span>Perros</span>
        </a>

        <!-- Bebidas -->
        <a class="filter-btn" 
           [class.active]="selectedCategory === 'bebida'"
           (click)="filterByCategory('bebida')">
          <i class="fas fa-glass-whiskey"></i><span>Bebidas</span>
        </a>

        <!-- Postres -->
        <a class="filter-btn" 
           [class.active]="selectedCategory === 'postre'"
           (click)="filterByCategory('postre')">
          <i class="fas fa-ice-cream"></i><span>Postres</span>
        </a>
      </div>
      
      <!-- Info de resultados de b√∫squeda -->
      <div *ngIf="searchTerm" class="search-results-info">
        <p>
          <i class="fas fa-search"></i>
          Mostrando <strong>{{ filteredProducts.length }}</strong>
          resultado{{ filteredProducts.length === 1 ? '' : 's' }}
          para "<strong>{{ searchTerm }}</strong>"
          ¬∑ <a (click)="clearSearch()">Limpiar b√∫squeda</a>
        </p>
      </div>

      <!-- Info de resultados de categor√≠a -->
      <div *ngIf="selectedCategory && !searchTerm" class="search-results-info">
        <p>
          <i class="fas fa-filter"></i>
          Mostrando <strong>{{ filteredProducts.length }}</strong>
          producto{{ filteredProducts.length === 1 ? '' : 's' }}
          en la categor√≠a "<strong>{{ selectedCategory | titlecase }}</strong>"
          ¬∑ <a (click)="filterByCategory(null)">Ver todos</a>
        </p>
      </div>

      <!-- Menu Grid -->
      <div class="menu-grid" id="menuGrid">
        <!-- Mensaje si no hay productos -->
        <div *ngIf="filteredProducts.length === 0" class="empty-state" style="grid-column: 1 / -1;">
          <i class="fas fa-search"></i>
          <h3>No se encontraron productos</h3>
          
          <p *ngIf="searchTerm">No hay productos que coincidan con "<strong>{{ searchTerm }}</strong>".</p>
          
          <p *ngIf="selectedCategory && !searchTerm">No hay productos en la categor√≠a "<strong>{{ selectedCategory | titlecase }}</strong>".</p>
          
          <p *ngIf="!searchTerm && !selectedCategory">Actualmente no hay productos disponibles.</p>
          
          <a (click)="clearFilters()" class="btn-load-more" style="display: inline-flex;">
            <span>Ver todos los productos</span>
            <i class="fas fa-arrow-right"></i>
          </a>
        </div>

        <!-- Loop de productos -->
        <article class="menu-card" 
                 *ngFor="let producto of filteredProducts"
                 [attr.data-id]="producto.id"
                 [attr.data-category]="producto.categoria.toLowerCase()"
                 [attr.data-price]="producto.precio"
                 [attr.data-name]="producto.nombre"
                 [attr.data-image]="producto.imgURL"
                 [attr.data-desc]="producto.descripcion"
                 role="button" 
                 tabindex="0"
                 (click)="openProductDetail(producto)"
                 title="Click para ver detalles y adicionales disponibles">
          
          <!-- Badge de producto nuevo -->
          <div *ngIf="producto.nuevo" class="menu-card-badge">Nuevo</div>
          
          <!-- Badge de producto popular -->
          <div *ngIf="producto.popular && !producto.nuevo" class="menu-card-badge sale">Popular</div>

          <div class="menu-card-image">
            <img [src]="producto.imgURL" 
                 [alt]="producto.nombre" 
                 class="menu-card-img"
                 (error)="onImageError($event)">
            
            <!-- Overlay con informaci√≥n adicional -->
            <div class="card-overlay">
              <div class="overlay-content">
                <p class="overlay-text">Ver detalles y adicionales</p>
                <i class="fas fa-eye overlay-icon"></i>
              </div>
            </div>
          </div>

          <div class="menu-card-content">
            <h3 class="menu-card-name">{{ producto.nombre }}</h3>
            <p class="menu-card-description">{{ producto.descripcion }}</p>
            
            <!-- Mostrar ingredientes simplificado -->
            <div *ngIf="producto.ingredientes && producto.ingredientes.length > 0" class="menu-card-ingredients">
              <small class="ingredients-label">Ingredientes:</small>
              <small class="ingredients-text">
                <!-- Mostrar solo los primeros 3 ingredientes -->
                <span *ngFor="let ing of producto.ingredientes.slice(0, 3); let i = index">
                  {{ ing }}<span *ngIf="i < 2 && i < producto.ingredientes.length - 1">, </span>
                </span>
                <span *ngIf="producto.ingredientes.length > 3">...</span>
              </small>
            </div>
            
            <div class="menu-card-footer">
              <span class="menu-card-price">${{ formatPrice(producto.precio) }}</span>
              <button class="btn-add-cart"
                      (click)="addToCart(producto, $event)"
                      [attr.data-product]="producto.nombre"
                      [attr.data-price]="producto.precio"
                      [attr.data-image]="producto.imgURL"
                      title="Agregar al carrito">
                <i class="fas fa-plus"></i>
              </button>
            </div>
          </div>
        </article>
      </div>

      <!-- Informaci√≥n adicional -->
      <div *ngIf="filteredProducts.length > 0" class="menu-info">
        <div class="products-count">
          <p>
            <i class="fas fa-utensils"></i>
            Mostrando <strong>{{ filteredProducts.length }}</strong> 
            producto{{ filteredProducts.length === 1 ? '' : 's' }}
            <span *ngIf="selectedCategory && !searchTerm">
              en <strong>{{ selectedCategory | titlecase }}</strong>
            </span>
          </p>
        </div>
        
        <!-- Call to action para usuarios no autenticados -->
        <div *ngIf="!isAuthenticated" class="auth-cta">
          <div class="cta-content">
            <h3>¬°√önete a Burger Club!</h3>
            <p>Crea tu cuenta para disfrutar de ofertas exclusivas y un mejor servicio</p>
            <div class="cta-buttons">
              <a routerLink="/auth/register" class="btn-cta primary">Registrarse</a>
              <a routerLink="/auth/login" class="btn-cta secondary">Iniciar Sesi√≥n</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- Footer -->
<footer class="site-footer">
  <div class="container">
    <div class="footer-social">
      <h3 class="follow-us">¬°S√≠guenos!</h3>
      <div class="social-links">
        <a href="#" class="social-link"><i class="fab fa-facebook-f"></i><span>Facebook</span></a>
        <a href="#" class="social-link"><i class="fab fa-instagram"></i><span>Instagram</span></a>
        <a href="#" class="social-link"><i class="fab fa-twitter"></i><span>Twitter</span></a>
        <a href="#" class="social-link"><i class="fab fa-whatsapp"></i><span>WhatsApp</span></a>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2024 Burger Club. Todos los derechos reservados.</p>
    </div>
  </div>
</footer>

<!-- Cart Modal -->
<div class="cart-modal" [class.active]="isCartOpen">
  <div class="cart-modal-content">
    <div class="cart-modal-header">
      <h2>Tu Carrito</h2>
      <button class="cart-close" (click)="closeCart()">&times;</button>
    </div>
    <div class="cart-modal-body">
      <div *ngIf="cartItems.length === 0" class="empty-cart">
        <p>Tu carrito est√° vac√≠o</p>
      </div>
      <div *ngFor="let item of cartItems" class="cart-item">
        <img [src]="item.image" [alt]="item.name" class="cart-item-image">
        <div class="cart-item-details">
          <h4>{{ item.name }}</h4>
          <p class="cart-item-price">${{ formatPrice(item.price) }}</p>
        </div>
        <div class="cart-item-quantity">
          <button (click)="decreaseQuantity(item)">-</button>
          <span>{{ item.quantity }}</span>
          <button (click)="increaseQuantity(item)">+</button>
        </div>
        <button class="cart-item-remove" (click)="removeFromCart(item)">
          <i class="fas fa-trash"></i>
        </button>
      </div>
    </div>
    <div class="cart-modal-footer" *ngIf="cartItems.length > 0">
      <div class="cart-total">
        <span>Total:</span>
        <span>${{ formatPrice(getCartTotal()) }}</span>
      </div>
      <button class="btn-checkout" (click)="proceedToCheckout()">Proceder al Pago</button>
    </div>
  </div>
</div>

<!-- Location Modal -->
<div *ngIf="isLocationModalOpen" class="location-modal" (click)="closeLocationModal()">
  <div class="location-modal-content" (click)="$event.stopPropagation()">
    <div class="location-modal-header">
      <h2>Nuestras Ubicaciones</h2>
      <button class="location-close" (click)="closeLocationModal()">&times;</button>
    </div>
    <div class="location-modal-body">
      <div class="location-item">
        <h3>Sede Principal</h3>
        <p><i class="fas fa-map-marker-alt"></i> Calle 123 #45-67, Bogot√°</p>
        <p><i class="fas fa-phone"></i> +57 1 234 5678</p>
      </div>
      <div class="location-item">
        <h3>Sede Norte</h3>
        <p><i class="fas fa-map-marker-alt"></i> Carrera 15 #89-12, Bogot√°</p>
        <p><i class="fas fa-phone"></i> +57 1 987 6543</p>
      </div>
    </div>
  </div>
</div>

<!-- Product Detail Modal -->
<div *ngIf="selectedProduct" class="product-detail-modal" (click)="closeProductDetail()">
  <div class="product-detail-content" (click)="$event.stopPropagation()">
    <div class="product-detail-header">
      <h2>{{ selectedProduct.nombre }}</h2>
      <button class="product-detail-close" (click)="closeProductDetail()">&times;</button>
    </div>
    <div class="product-detail-body">
      <img [src]="selectedProduct.imgURL" [alt]="selectedProduct.nombre" class="product-detail-image">
      <div class="product-detail-info">
        <p class="product-detail-description">{{ selectedProduct.descripcion }}</p>
        <div *ngIf="selectedProduct.ingredientes && selectedProduct.ingredientes.length > 0" class="product-detail-ingredients">
          <h4>Ingredientes:</h4>
          <ul>
            <li *ngFor="let ingrediente of selectedProduct.ingredientes">{{ ingrediente }}</li>
          </ul>
        </div>
        <div class="product-detail-price">
          <span class="price-label">Precio:</span>
          <span class="price-value">${{ formatPrice(selectedProduct.precio) }}</span>
        </div>
      </div>
    </div>
    <div class="product-detail-footer">
      <button class="btn-add-to-cart-detail" (click)="addToCart(selectedProduct)">
        <i class="fas fa-shopping-cart"></i>
        Agregar al Carrito
      </button>
    </div>
  </div>
</div>